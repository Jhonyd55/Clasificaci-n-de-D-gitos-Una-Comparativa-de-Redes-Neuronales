<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <title>Clasificación de Dígitos con IA</title>
    <link rel="stylesheet" href="CSS/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>

<body>

    <main class="container py-4">
        <header class="text-center pb-3 mb-4 header-section">
            <h1 class="display-5 fw-bold text-white">Clasificación de Dígitos con Redes Neuronales</h1>
            <div class="col-lg-8 mx-auto">
                <p class="lead mb-0 text-white-50">
                    Una aplicación interactiva para comparar el rendimiento de diferentes arquitecturas de redes neuronales en la clasificación de dígitos escritos a mano.
                </p>
            </div>
        </header>

        <section class="row align-items-center mb-4 main-content-section">
            <div class="col-12 col-md-6 d-flex flex-column align-items-center mb-4 mb-md-0">
                <h2 class="h4 mb-3 text-white">Dibuja un dígito aquí</h2>
                <div id="canvas-container" class="canvas-container">
                    <canvas id="bigcanvas" width="200" height="200" style="border:1px solid #ffffff;"></canvas>
                    <canvas id="smallcanvas" width="28" height="28" style="display: none;"></canvas>
                </div>
                <div class="mt-3 button-group">
                    <button class="btn btn-primary" id="limpiar" onclick="limpiar()">Limpiar</button>
                    <button class="btn btn-success" id="predecir" onclick="predecir()">Predecir</button>
                </div>
            </div>
            
            <div class="col-12 col-md-6 d-flex flex-column align-items-center">
                <h2 class="h4 mb-3 text-white">Resultados de la Predicción</h2>
                <div class="table-responsive prediction-table">
                    <table class="table text-center table-borderless">
                        <thead>
                            <tr class="text-white-50">
                                <th>Modelo 1</th>
                                <th>Modelo 2</th>
                                <th>Modelo 3</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><div id="resultado" class="resultado fw-bold fs-2 text-white"></div></td>
                                <td><div id="resultado2" class="resultado fw-bold fs-2 text-white"></div></td>
                                <td><div id="resultado3" class="resultado fw-bold fs-2 text-white"></div></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <hr class="my-5 divider">

        <section class="row justify-content-center text-center chart-section">
            <div class="col-12 col-lg-10">
                <h2 class="h4 mb-3 text-white">Gráficas de Precisión y Pérdida de Entrenamiento</h2>
                <p class="text-muted text-white-50">
                    Comparación de la precisión y pérdida de los modelos durante el entrenamiento.
                </p>
                <div class="chart-container">
                    <canvas id="myChart" width="400" height="200"></canvas>
                </div>
            </div>
        </section>

        <hr class="my-5 divider">

        <footer class="text-secondary px-4 py-2 footer-section">
            <div class="py-3 text-center">
                <h1 class="display-5 fw-bold text-white">jhonyd55</h1>
                <p class="fs-5 mb-0 text-white-50">
                    Desarrollador de proyectos de Machine Learning. Este trabajo es una demostración de la implementación de modelos de IA directamente en el navegador web.
                </p>
                <div class="mt-3">
                    <a href="https://www.tensorflow.org/js?hl=es-419" target="_blank" class="text-white text-decoration-none mx-2 footer-link">
                        TensorFlow.js
                    </a>
                    <span class="text-white mx-1">|</span>
                    <a href="https://github.com/jhonyd55" target="_blank" class="text-white text-decoration-none mx-2 footer-link">
                        GitHub
                    </a>
                </div>
            </div>
        </footer>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="JS/fabric.min.js"></script>
    <script src="JS/drawing.js"></script>
    <script src="JS/javascript.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const ctx = document.getElementById('myChart').getContext('2d');
            const historyFiles = ['history/history1.json', 'history/history2.json'];
            
            Promise.all(historyFiles.map(file => fetch(file).then(res => res.json())))
                .then(histories => {
                    const history1 = histories[0];
                    const history2 = histories[1];

                    const labels = Array.from({length: Math.max(history1.loss.length, history2.loss.length)}, (_, i) => `Época ${i + 1}`);

                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Pérdida (Modelo 1)',
                                data: history1.loss,
                                borderColor: 'rgba(255, 99, 132, 1)',
                                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                fill: false,
                                tension: 0.1
                            }, {
                                label: 'Precisión (Modelo 1)',
                                data: history1.accuracy,
                                borderColor: 'rgba(54, 162, 235, 1)',
                                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                fill: false,
                                tension: 0.1
                            }, {
                                label: 'Pérdida (Modelo 2)',
                                data: history2.loss,
                                borderColor: 'rgba(255, 159, 64, 1)',
                                backgroundColor: 'rgba(255, 159, 64, 0.2)',
                                fill: false,
                                tension: 0.1
                            }, {
                                label: 'Precisión (Modelo 2)',
                                data: history2.accuracy,
                                borderColor: 'rgba(75, 192, 192, 1)',
                                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                fill: false,
                                tension: 0.1
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                })
                .catch(error => console.error('Error al cargar los datos del historial:', error));
        });
    </script>
</body>
</html>
